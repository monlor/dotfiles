#!/bin/bash

# bat wrapper script with adaptive theme switching

get_macos_appearance() {
    if [[ "$OSTYPE" == "darwin"* ]]; then
        # Get macOS appearance mode
        local mode=$(defaults read -g AppleInterfaceStyle 2>/dev/null || echo "Light")
        echo "$mode"
    else
        # Default to Dark for non-macOS
        echo "Dark"
    fi
}

set_bat_theme() {
    local appearance=$(get_macos_appearance)

    if [[ "$appearance" == "Dark" ]]; then
        # Dark mode theme
        export BAT_THEME="Monokai Extended Bright"
    else
        # Light mode theme
        export BAT_THEME="GitHub"
    fi
}

# Set adaptive theme
set_bat_theme

# Execute bat with all arguments (let system find the correct path)
exec command bat "$@"